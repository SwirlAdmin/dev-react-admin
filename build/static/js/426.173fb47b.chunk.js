"use strict";(self.webpackChunkswirl_dashboard=self.webpackChunkswirl_dashboard||[]).push([[426],{23879:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var s=a(65043),l=a(73722),n=a(47994),o=a(53688),r=a(21467),d=a(59478),i=(a(95365),a(45394)),c=(a(91123),a(60184)),p=(a(57270),a(49804)),u=a(77154),h=a(83003),m=a(91036),v=(a(55508),a(5060)),x=a.n(v),g=a(96690),y=a(79936),j=(a(40932),a(54213),a(73216)),b=a(41591),f=a(70579);const N=()=>{const e=(0,j.Zp)(),[t,a]=(0,s.useState)("0"),[v,N]=(0,s.useState)("0"),[w,S]=(0,s.useState)([]),[_,C]=(0,s.useState)("US"),[U,I]=(0,s.useState)("0"),[k,A]=(0,s.useState)("#000000"),[T,R]=(0,s.useState)("#ffa800"),[B,E]=(0,s.useState)(!1),[L,F]=(0,s.useState)(!1),[D,O]=(0,s.useState)(null),[J,P]=(0,s.useState)(null),[z,K]=(0,s.useState)(!1),V=(0,s.useRef)(null),W=(0,s.useRef)(null),[q,H]=(0,s.useState)(null),[M,Z]=(0,s.useState)([]),[G,Q]=(0,s.useState)(0),[X,Y]=(0,s.useState)(null),$=(0,h.d4)((e=>e.auth.user)),[ee,te]=(0,s.useState)([]),[ae,se]=(0,s.useState)([]),[le,ne]=(0,s.useState)({}),[oe,re]=(0,s.useState)(""),[de,ie]=(0,s.useState)(null),[ce,pe]=(0,s.useState)(!1),[ue,he]=(0,s.useState)({videoTitle:"",ctaBtn:"",videURL:"",pageUrl:"",videoType:"",videLength:0}),[me,ve]=(0,s.useState)({}),xe=(0,j.zy)().pathname.split("/"),ge=(xe[xe.length-1],(0,h.d4)((e=>e.auth.videoDataForEdit)));function ye(e,t){if(0===e.length)return"";return e.map((e=>e[t])).join(", ")}const je=(0,s.useRef)(null),be=()=>{E(!B)},fe=e=>{const{name:t,value:a}=e.target;he((e=>({...e,[t]:a})))},Ne=()=>{F(!L)},we=e=>{N(e.target.value)};(0,s.useEffect)((()=>{const e=e=>{V.current&&!V.current.contains(e.target)&&E(!1),W.current&&!W.current.contains(e.target)&&F(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const Se=(0,s.useRef)(null),_e=async e=>{e.preventDefault(),pe(!0);try{const e=new FormData;e.append("image",de),e.append("videoId",ge.video_id),e.append("uploadType",t),e.append("selectedCallNowType",U),e.append("videURL",ue.videURL),e.append("videoTitle",ue.videoTitle),e.append("cta_type",v),e.append("tollfree_or_phone",U),e.append("ctaButton",JSON.stringify({cta_btn_text:ue.ctaBtn,cta_bg_color:k,cta_text_color:T})),e.append("selectedPlylist",ye(M,"id")),e.append("connected_products",ye(w,"productId")),e.append("videoType",ue.videoType),e.append("video_duration",ue.videLength),e.append("country",function(e){const t=x().find((t=>t.code===e));return t?t.phoneCode:null}(_)),e.append("number",oe),e.append("brandId",$.brand_id),e.append("productUrl",ue.pageUrl),await u.A.patch("http://192.168.1.180:3001/updateVideoData",e,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{pe(!1),m.oR.success("Swirl updated successfully!")})).catch((e=>{console.log(e),pe(!1),m.oR.error("Something went wrong !")}))}catch(a){console.log(a),m.oR.error("Something went wrong !")}};(0,s.useEffect)((()=>{(async()=>{try{await u.A.get("http://192.168.1.180:3001/getPlaylistByBrandId?brandId=".concat($.brand_id)).then((e=>{e.data.playlist?te(e.data.playlist):te([])}))}catch(e){console.log(e)}})(),(async()=>{try{await u.A.get("http://192.168.1.180:3001/getProductsByBrandId?brandId=".concat($.brand_id)).then((e=>{e.data.products?se(e.data.products):se([])}))}catch(e){console.log(e)}})(),(async()=>{try{await u.A.get("http://192.168.1.180:3001/getSwirlShortCodeInfoByBrandId?brandId=".concat($.brand_id)).then((e=>{e.data.sscResponse&&ne(e.data.sscResponse.brandCustomization)}))}catch(e){console.log(e)}})(),(async()=>{try{await u.A.get("http://192.168.1.180:3001/getVideoInfoByVideoId?videoId=".concat(ge.video_id)).then((e=>{var t;null!==(t=e.data)&&void 0!==t&&t.swirl&&ve(e.data.swirl)})).catch((e=>{console.log(e)}))}catch(e){}})()}),[]),(0,s.useEffect)((()=>{if(me){const a=ee.filter((e=>{var t;return((null===me||void 0===me||null===(t=me.playlistId)||void 0===t?void 0:t.split(","))||[]).includes(e.id.toString())}));if(Z(a),Y(me.coverImage),ie(me.coverImage),P(me.serverUrl),he((e=>({...e,pageUrl:me.shopifyUrl}))),me.shopifyUrl)if(me.shopifyUrl.includes("https")||me.shopifyUrl.includes("http"))N("1"),he((e=>{var t;return{...e,pageUrl:null===me||void 0===me||null===(t=me.shopifyUrl)||void 0===t?void 0:t.trim()}}));else if(N("2"),me.shopifyUrl.includes("+")){var e;I("1");const t=null===me||void 0===me||null===(e=me.shopifyUrl)||void 0===e?void 0:e.split("+");re(t[2].trim()),C(function(e){let t;return"+1"==e?t="US":"+91"==e?t="IN":"+61"==e&&(t="AU"),t}("+".concat(t[1].trim())))}else{var t;I("0"),re(null===me||void 0===me||null===(t=me.shopifyUrl)||void 0===t?void 0:t.trim())}else if(me.productId){N("0");const e=ae.filter((e=>{var t,a;return((null===me||void 0===me||null===(t=me.productId)||void 0===t||null===(a=t.split(","))||void 0===a?void 0:a.map((e=>e.trim())))||[]).includes(e.productId.toString())}));S(e)}}}),[ee,me]),(0,s.useEffect)((()=>{he((e=>({...e,videoTitle:me.videoTitle}))),null!==me&&void 0!==me&&me.ctaButton&&(JSON.parse(null===me||void 0===me?void 0:me.ctaButton).cta_bg_color?(he((e=>({...e,ctaBtn:JSON.parse(me.ctaButton).cta_btn_text}))),A(JSON.parse(me.ctaButton).cta_bg_color),R(JSON.parse(me.ctaButton).cta_text_color)):(he((e=>({...e,ctaBtn:le.buy_btn}))),A(le.bk_color_buy_btn),R(le.front_color_buy_btn)))}),[le,me]),(0,s.useEffect)((()=>{(()=>{const e=je.current;e&&e.addEventListener("loadedmetadata",(()=>{const t=e.videoWidth,a=e.videoHeight;he((t=>({...t,videLength:e.duration}))),he(a>t?e=>({...e,videoType:"portrait"}):t===a?e=>({...e,videoType:"square"}):e=>({...e,videoType:"landscape"}))}))})()}),[J]);return(0,s.useEffect)((()=>{ue.pageUrl&&(async()=>{const e=ue.pageUrl;try{const t=await u.A.get("https://cors-anywhere.herokuapp.com/"+e),a=(new DOMParser).parseFromString(t.data,"text/html").getElementsByTagName("title")[0],s=a?a.innerText:"No title found";s&&he((e=>({...e,videoTitle:s})))}catch(t){console.log(t)}})()}),[ue.pageUrl]),(0,f.jsxs)("div",{style:{overflow:"hidden"},children:[(0,f.jsx)(b.m,{children:(0,f.jsx)("title",{children:"SWIRL | Video edit"})}),(0,f.jsxs)("div",{className:"row",children:[(0,f.jsxs)("div",{className:"col-8",style:{height:"80vh",overflow:"auto"},children:[(0,f.jsxs)("p",{className:"d-flex align-items-center gap-2",children:[(0,f.jsx)(p.OLK,{title:"back",style:{cursor:"pointer"},onClick:()=>e("/admin/svideos"),size:20}),"Edit Video"]}),(0,f.jsx)("div",{className:"row text-muted",children:(0,f.jsxs)(l.A,{onSubmit:e=>{_e(e)},children:[(0,f.jsxs)("label",{className:"mt-3",children:["Title ",(0,f.jsx)("sup",{className:"text-danger",children:"*"})]}),(0,f.jsx)(l.A.Control,{type:"text",className:"mt-2",placeholder:"Enter video title",value:ue.videoTitle,name:"videoTitle",onChange:e=>{fe(e)},required:!0}),(0,f.jsxs)("div",{className:"d-flex mt-3",children:[(0,f.jsx)(l.A.Check,{type:"radio",label:"Connect products",name:"connect_product",id:"connect_product",value:"0",className:"0"===v?"selected-radio":"",checked:"0"===v,onChange:we}),(0,f.jsx)(l.A.Check,{type:"radio",label:"Add URL",name:"add_url",id:"add_url",value:"1",className:"ms-3 ".concat("1"===v?"selected-radio":""),checked:"1"===v,onChange:we}),(0,f.jsx)(l.A.Check,{type:"radio",label:"Call now",name:"c_now",id:"c_now",value:"2",className:"ms-3 ".concat("2"===v?"selected-radio":""),checked:"2"===v,onChange:we})]}),(0,f.jsxs)("div",{children:["0"===v&&(0,f.jsx)(y.A,{data:ae,selectedItems:w,setSelectedItems:S}),"1"===v&&(0,f.jsx)(l.A.Control,{type:"text",className:"form-control mt-3",placeholder:"Add page URL",name:"pageUrl",value:ue.pageUrl,onChange:e=>{fe(e)}}),"2"===v&&(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("div",{className:"row mt-3",children:[(0,f.jsx)("div",{className:"col-3",children:(0,f.jsxs)(l.A.Select,{"aria-label":"select call now type",className:"text-muted",onChange:e=>{I(e.target.value)},children:[(0,f.jsx)("option",{selected:"0"===U,value:"0",children:"Toll-free"}),(0,f.jsx)("option",{selected:"1"===U,value:"1",children:"Phone number"})]})}),(0,f.jsx)("div",{className:"col-9",children:"0"==U?(0,f.jsx)(l.A.Control,{type:"number",value:oe,onChange:e=>re(e.target.value),placeholder:"0"==U?"Enter toll-free number":"Enter phone number","aria-label":"Text input with dropdown button"}):(0,f.jsxs)(n.A,{className:"mb-3 country_btn",children:[(0,f.jsxs)(o.A,{variant:"outline-dark",title:_,className:"country_btn",onSelect:e=>{C(e)},style:{border:"1px solid red"},children:[(0,f.jsx)(r.A.Item,{eventKey:"US",children:"US"}),(0,f.jsx)(r.A.Item,{eventKey:"IN",children:"IN"}),(0,f.jsx)(r.A.Item,{eventKey:"AU",children:"AU"})]}),(0,f.jsx)(l.A.Control,{type:"number",value:oe,placeholder:"0"==U?"Enter toll-free number":"Enter phone number","aria-label":"Text input with dropdown button",onChange:e=>re(e.target.value)})]})})]})}),(0,f.jsx)("p",{className:"mt-3",children:"Overlay CTA button"}),(0,f.jsxs)("div",{className:"row mt-2",children:[(0,f.jsx)("div",{className:"col-4",children:(0,f.jsx)("input",{type:"text",value:ue.ctaBtn,placeholder:"Enquire now",className:"form-control",name:"ctaBtn",onChange:e=>fe(e)})}),(0,f.jsxs)("div",{className:"col-4",children:[(0,f.jsxs)("div",{className:"input-group mb-3",children:[(0,f.jsx)("span",{className:"input-group-text",children:(0,f.jsx)("span",{className:"color_badge",style:{backgroundColor:k}})}),(0,f.jsx)("input",{type:"text",value:k,onClick:be,className:"form-control pointer_cursor"}),(0,f.jsx)("span",{className:"input-group-text pointer_cursor",onClick:be,children:(0,f.jsx)(i.dJp,{})})]}),B&&(0,f.jsx)("div",{ref:V,style:{position:"absolute",zIndex:"2"},children:(0,f.jsx)(d.xk,{color:k,onChange:e=>{A(e.hex)}})})]}),(0,f.jsxs)("div",{className:"col-4",children:[(0,f.jsxs)("div",{className:"input-group mb-3",children:[(0,f.jsx)("span",{className:"input-group-text",children:(0,f.jsx)("span",{className:"color_badge",style:{backgroundColor:T}})}),(0,f.jsx)("input",{type:"text",value:T,onClick:Ne,className:"form-control pointer_cursor"}),(0,f.jsx)("span",{className:"input-group-text pointer_cursor",onClick:Ne,children:(0,f.jsx)(i.dJp,{})})]}),L&&(0,f.jsx)("div",{ref:W,style:{position:"absolute",zIndex:"2"},children:(0,f.jsx)(d.xk,{color:T,onChange:e=>{R(e.hex)}})})]})]})]}),(0,f.jsx)("p",{className:"d-none",children:"Select playlist"}),(0,f.jsx)("p",{className:"mt-2",children:"Cover image"}),(0,f.jsx)("div",{className:"input-group ",children:(0,f.jsx)(l.A.Control,{ref:Se,type:"file",accept:"image/*",placeholder:"Select an image file","data-browse":"Browse",onChange:e=>{const t=e.target.files[0];if(t){ie(t);const e=new FileReader;e.onloadend=()=>{const t=e.result;Y(t)},e.readAsDataURL(t)}}})}),(0,f.jsx)("small",{children:"File format: .png, .jpg, .webp"}),X&&(0,f.jsx)(f.Fragment,{children:(0,f.jsx)("div",{className:"card p-2 col-4 mt-4 m-auto",children:(0,f.jsx)("img",{alt:"preview",className:"rounded",src:X})})}),(0,f.jsx)("div",{children:(0,f.jsxs)("button",{className:"btn btn-sm mt-3 btn-dark",children:["Update ",ce?(0,f.jsx)(c.hW,{className:"spinning"}):""]})})]})})]}),(0,f.jsx)("div",{className:"col-4",children:(0,f.jsx)("div",{className:"card",style:{height:"80vh",padding:"50px",paddingTop:"20px",borderRadius:"20px",overflow:"hidden",backgroundColor:"#F8F8FF",borderRadius:"10px"},children:(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{style:{position:"relative",height:"70vh",maxWidth:"100%",overflow:"hidden",borderRadius:"20px"},children:[J?(0,f.jsx)("video",{ref:je,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover"},src:J,autoPlay:!0,muted:!0}):(0,f.jsx)("div",{className:"h-100 w-100",style:{backgroundColor:"#D9D9D9"}}),D&&(0,f.jsx)("div",{style:{position:"absolute",top:0,right:0,padding:"10px",color:"white"},onClick:()=>{O(null),P(null)},children:(0,f.jsx)("span",{style:{height:"34px",width:"34px",backgroundColor:"#a2a2a4",cursor:"pointer",borderRadius:"50%",display:"grid",placeItems:"center"},children:(0,f.jsx)(p.id1,{className:" float-end"})})}),(0,f.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",color:"white"},children:(0,f.jsx)("div",{style:{backgroundColor:"#ffffff",height:"44px",width:"44px",display:"grid",placeItems:"center",borderRadius:"50%"},children:(0,f.jsx)(c.gSK,{size:20,className:"ps-1 pointer_cursor",color:"#09121F"})})}),w.length>0&&(0,f.jsx)("div",{className:"w-100 p-3",style:{position:"absolute",bottom:"0"},children:(0,f.jsx)("div",{className:"d-flex bg-light rounded overflow-hidden",style:{boxShadow:"0px 4px 4px 0px #00000040"}})})]}),(0,f.jsx)("div",{className:"text-center",children:(0,f.jsx)("button",{className:"btn btn-dark mt-2",disabled:!X,onClick:()=>K(!0),children:"Preview"})})]})})}),(0,f.jsx)(g.A,{show:z,url:J,handleClose:()=>{K(!1)}})]})]})}}}]);
//# sourceMappingURL=426.173fb47b.chunk.js.map